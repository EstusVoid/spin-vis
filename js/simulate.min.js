var bluewhitered="vec3 colormap(vec3 direction) {     if (direction.z < 0.0) {         vec3 color_down = vec3(0.0, 0.0, 1.0);         vec3 color_up = vec3(1.0, 1.0, 1.0);         return mix(color_down, color_up, normalize(direction).z+1.0);     } else {         vec3 color_down = vec3(1.0, 1.0, 1.0);         vec3 color_up = vec3(1.0, 0.0, 0.0);         return mix(color_down, color_up, normalize(direction).z);     } }";let webglspins,iteration=0,n=0,simulateObject={insertedFile:"",spinPositions:[],spinDirections:[],spinNeighbor:[],simulateNew:t=>{n=t,simulateObject.spinPositions=[],simulateObject.spinDirections=[],webglspins=simulateObject.createwebglspins(),iteration+=1;for(var e=0;e<Math.sqrt(n);e++)for(var i=0;i<Math.sqrt(n);i++){var s=[2*i,2*e,0];Array.prototype.push.apply(simulateObject.spinPositions,s);var a=[Math.sin(.3*i)*Math.cos(.05*(e+iteration)),Math.cos(.3*i)*Math.cos(.05*(e+iteration)),Math.sin(.05*(e+iteration))];Array.prototype.push.apply(simulateObject.spinDirections,a)}webglspins.updateSpins(simulateObject.spinPositions,simulateObject.spinDirections),simulateObject.neighbors()},simulateByData:()=>{n=simulateObject.spinPositions.length/3,webglspins=simulateObject.createwebglspins(),webglspins.updateSpins(simulateObject.spinPositions,simulateObject.spinDirections),simulateObject.neighbors()},downloadFile:()=>{const t=parseToFile(simulateObject.spinPositions,simulateObject.spinDirections);var e=new Blob(t,{type:"text/plain"});saveAs(e,"spins.txt")},createwebglspins:()=>new WebGLSpins(document.getElementById("webgl-canvas"),{cameraLocation:[Math.sqrt(n)/1.5,.95*Math.sqrt(n),2.5*Math.sqrt(n)],centerLocation:[Math.sqrt(n)/1.5,.95*Math.sqrt(n),0],upVector:[0,1,0],levelOfDetail:5,backgroundColor:[.1,.11,.13],colormapImplementation:bluewhitered,renderers:[WebGLSpins.renderers.ARROWS,[WebGLSpins.renderers.SPHERE,[0,0,.2,.2]],[WebGLSpins.renderers.COORDINATESYSTEM,[0,.2,.2,.2]]]}),neighbors:()=>{for(var t=0;t<Math.sqrt(n);t++)for(var e=0;e<Math.sqrt(n);e++){var i=4*(t*Math.sqrt(n)+e);simulateObject.spinNeighbor[i]=simulateObject.border_check(t+1)*Math.sqrt(n)+e,simulateObject.spinNeighbor[i+1]=t*Math.sqrt(n)+simulateObject.border_check(e+1),simulateObject.spinNeighbor[i+2]=simulateObject.border_check(t-1)*Math.sqrt(n)+e,simulateObject.spinNeighbor[i+3]=t*Math.sqrt(n)+simulateObject.border_check(e-1)}},magnetization(t){for(var e,i=0,s=0,a=0,r=0;r<3*n;r+=3)i+=simulateObject.spinDirections[r],s+=simulateObject.spinDirections[r+1],a+=simulateObject.spinDirections[r+2];e=Math.sqrt(i*i+s*s+a*a)/n,t.display.value=Math.abs(e)},ferromagnetic_create(){simulateObject.spinPositions=[],simulateObject.spinDirections=[];for(var t=0;t<Math.sqrt(n);t++)for(var e=0;e<Math.sqrt(n);e++){var i=[2*e,2*t,0];Array.prototype.push.apply(simulateObject.spinPositions,i);Array.prototype.push.apply(simulateObject.spinDirections,[0,0,1])}webglspins.updateSpins(simulateObject.spinPositions,simulateObject.spinDirections),simulateObject.neighbors()},border_check:t=>(Math.sqrt(n)+t)%Math.sqrt(n),espin(t){var e=0,i=3*t,s=3*t+1,n=3*t+2,a=3*simulateObject.spinNeighbor[4*t],r=3*simulateObject.spinNeighbor[4*t+1],o=3*simulateObject.spinNeighbor[4*t+2],c=3*simulateObject.spinNeighbor[4*t+3];return e+=simulateObject.spinDirections[i]*(simulateObject.spinDirections[a]+simulateObject.spinDirections[r]+simulateObject.spinDirections[o]+simulateObject.spinDirections[c]),e+=simulateObject.spinDirections[s]*(simulateObject.spinDirections[a+1]+simulateObject.spinDirections[r+1]+simulateObject.spinDirections[o+1]+simulateObject.spinDirections[c+1]),-1*(e+=simulateObject.spinDirections[n]*(simulateObject.spinDirections[a+2]+simulateObject.spinDirections[r+2]+simulateObject.spinDirections[o+2]+simulateObject.spinDirections[c+2]))},energy(t){for(var e=0,i=0;i<n;++i)e+=simulateObject.espin(i);e/=2*n,t.display.value=e},getRandomInclusive:(t,e)=>(t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t),getRandomIzing:()=>0===Math.floor(2*Math.random())?-1:1,randomspinIzing_create(){iteration+=1,simulateObject.spinPositions=[],simulateObject.spinDirections=[];for(var t=0;t<Math.sqrt(n);t++)for(var e=0;e<Math.sqrt(n);e++){var i=simulateObject.getRandomIzing(),s=[2*e,2*t,0];Array.prototype.push.apply(simulateObject.spinPositions,s);var a=[0,0,i];Array.prototype.push.apply(simulateObject.spinDirections,a)}webglspins.updateSpins(simulateObject.spinPositions,simulateObject.spinDirections)},randomspin_create(){Math.sqrt(n);simulateObject.spinPositions=[],simulateObject.spinDirections=[];for(var t=0;t<Math.sqrt(n);t++)for(var e=0;e<Math.sqrt(n);e++){var i=[2*e,2*t,0];Array.prototype.push.apply(simulateObject.spinPositions,i);var s=simulateObject.getRandomInclusive(0,360),a=simulateObject.getRandomInclusive(0,180),r=s*Math.PI/180,o=a*Math.PI/180,c=[Math.sin(o)*Math.cos(r),Math.sin(o)*Math.sin(r),Math.cos(o)];Array.prototype.push.apply(simulateObject.spinDirections,c)}webglspins.updateSpins(simulateObject.spinPositions,simulateObject.spinDirections)},skyrmion_create(){var t=.125*Math.sqrt(n);simulateObject.spinPositions=[],simulateObject.spinDirections=[];for(var e=0;e<Math.sqrt(n);e++)for(var i=0;i<Math.sqrt(n);i++){var s=[2*i,2*e,0];Array.prototype.push.apply(simulateObject.spinPositions,s);var a=i-Math.sqrt(n)/2,r=e-Math.sqrt(n)/2,o=a*a+r*r+t*t,c=[-t*a/o,-t*r/o,(a*a+r*r-t*t)/o];Array.prototype.push.apply(simulateObject.spinDirections,c)}webglspins.updateSpins(simulateObject.spinPositions,simulateObject.spinDirections)},default_camera(){webglspins.updateOptions({cameraLocation:[Math.sqrt(n)/1.5,.95*Math.sqrt(n),2.5*Math.sqrt(n)],centerLocation:[Math.sqrt(n)/1.5,.95*Math.sqrt(n),0],upVector:[0,1,0]})}};function parseToFile(t,e){const i=[];for(let s=0;s<t.length;s+=3){let n=t.slice(s,s+3),a=e.slice(s,s+3),r=n.map((t=>t+" \t")),o=a.map((t=>t+" \t")),c="";r.forEach((t=>c+=t)),o.forEach((t=>c+=t)),s!=t.length-3&&(c+="\n"),i.push(c)}return i}function parseToArrays(t,e){const i=t.split("\n");e.spinPositions=[],e.spinDirections=[];for(let t=0;t<i.length;t+=1){let s=i[t].split("\t"),n=s.slice(0,3),a=s.slice(3,6);for(let t=0;t<3;t++){const i=parseFloat(n[t]),s=parseFloat(a[t]);e.spinPositions.push(i),e.spinDirections.push(s)}}}